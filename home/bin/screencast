#!/usr/bin/bash
if ! v4l2-ctl --list-devices; then
    pass modprobe v4l2loopback exclusive_caps=1 card_label=WfRecorder
fi

monitors=$(swaymsg -t get_outputs -r | jq 'map(.id,.name) | join (" ")' | cut -d '"' -f2)


monitor=$(zenity --list --text="Selecione o monitor" --radiolist --column="Select" --column="Monitor" $monitors) && \
    wf-recorder --muxer=v4l2 --codec=rawvideo --pixel-format=yuv420p --file=/dev/video0 --output $monitor || \
    exit -1
