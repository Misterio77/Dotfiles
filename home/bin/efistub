#!/usr/bin/bash
disk="Arch"
label="Arch Linux"
parameters="quiet splash loglevel=0 rd.systemd.show_status=auto rd.udev.log_priority=3 vt.global_cursor_default=0 amd_iommu=off"

efibootmgr | grep "$label" | cut -d '*' -f1 | \
while read line; do
    entry=$(echo $line | cut -d 't' -f2)
	sudo efibootmgr -b $entry -B
done

rootuuid=$(lsblk -o LABEL,UUID | grep $disk | cut -d ' ' -f3)

sudo efibootmgr -c -L "$label (Zen)" -l /vmlinuz-linux-zen -d /dev/nvme0n1p1 -u "root=UUID=$rootuuid rw initrd=\initramfs-linux-zen.img $parameters" --verbose
sudo efibootmgr -c -L "$label (Vanilla)" -l /vmlinuz-linux -d /dev/nvme0n1p1 -u "root=UUID=$rootuuid rw initrd=\initramfs-linux.img $parameters" --verbose
